Changed `auto_attach` to optionally set speed and protocol.